{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","self","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","error","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","erro","importa","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\t\n\tconstructor() {\n\n\t\tlet $ = document.querySelector.bind(document);\n\t\tthis._inputData = $('#data');\n\t\tthis._inputQuantidade = $('#quantidade');\n\t\tthis._inputValor = $('#valor');\n\n\t\tlet self = this;\n\t\t\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\t\tnew ListaNegociacoes(),\n\t\t\t\tnew NegociacoesView($('#negociacoesView')),\n\t\t\t\t'adiciona', 'esvazia');\n\t\t\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(),\n\t\t\tnew MensagemView($('#mensagemView')),\n\t\t\t'texto');\n\n\t\tthis._service = new NegociacaoService();\n\t\tthis._init();\n\t}\n\n\t_init() {\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes =>\n\t\t\t\tnegociacoes.forEach(negociacao =>\n\t\t\t\t  this._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch(erro => this._mensagem.texto = error);\n\n\t\tsetInterval(() => {\n\t\t\tthis.importaNegociacoes();\n\t\t}, 3000);\n\t}\n\n\tadiciona(event) {\n\n\t\tevent.preventDefault();\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\t}\n\n\timportaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then(negociacoes => negociacoes.forEach(negociacao => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = 'Negociações do período importadas'\n\t\t\t}))\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\t}\n\tapaga() {\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._listaNegociacoes.esvazia();\n\t\t\t})\n\t\t\t.catch(error => this._mensagem.texto = erro);\n\t}\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value))\n\t}\n\n\t_limpaFormulario() {\n\t\tthis._inputData.value = '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\n\t\tthis._inputData.focus();\n\t}\n}"]}